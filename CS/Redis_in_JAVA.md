## Redis 사용하기

Redis를 활용한 인증 처리 및 조회수 성능 최적화
스프링(Spring) 등 웹 개발 환경에서 Redis를 사용하는 가장 보편적인 방식은 웹 서버(또는 WAS)와 메인 DB 사이에 In-memory 기반의 Redis 서버를 별도로 두어, 빈번하게 접근하는 데이터를 캐싱하는 것이다.

1. Refresh Token 저장소로서의 활용
일반적으로 사용자 정보와 Refresh Token을 Redis에 저장하는 방식을 많이 사용한다. 사용자가 만료된 Access Token을 갱신하기 위해 Refresh Token을 보낼 때, 디스크 I/O가 발생하는 RDB(MySQL 등)까지 가서 검증하는 것은 비효율적이다. 대신 메모리 기반이라 접근 속도가 매우 빠른 Redis에서 토큰의 유효성을 검증(Validation)함으로써, 메인 DB의 부하를 줄이고 응답 속도를 획기적으로 개선할 수 있다.

2. 조회수(View Count) 성능 최적화 (Write-Back 패턴)
단순한 토큰 저장을 넘어, 잦은 DB 접속을 막기 위해 '공구(공동구매) 앱' 프로젝트에서는 조회수 로직에 Redis를 적극 활용하였다.

문제점 (MySQL의 한계): 사용자가 게시글을 읽을 때마다 MySQL에 직접 UPDATE 쿼리를 날려 조회수를 증가시키는 것은 성능상 치명적이다. MySQL(InnoDB 엔진)에서 단순 읽기(SELECT)는 락(Lock) 없이 가능하지만, 쓰기(UPDATE) 작업은 **레코드 락(Record Lock)**을 걸고 Redo/Undo 로그를 버퍼에 기록하는 등 무거운 작업이 동반되기 때문이다. 트래픽이 몰릴 경우 이 과정에서 심각한 병목 현상이 발생한다.

해결책 (Redis 캐싱): 따라서 조회수 증가 요청이 들어오면 DB에 바로 반영하지 않고, Redis의 INCR 명령어 등을 사용해 메모리상에서 즉시 카운트를 올리는 방식을 택했다.

3. 데이터 동기화 및 인기글 산정
Redis에 쌓인 조회수 데이터는 스케줄러를 통해 30분 주기로 메인 DB에 일괄 업데이트(Bulk Update)한다. 즉, 빈번한 쓰기 작업을 모아서 한 번에 처리하는 Write-Back(쓰기 지연) 전략을 사용하여 DB 부하를 최소화한 것이다. 또한, Redis에 실시간으로 집계된 조회수 데이터를 바탕으로 '인기 공구 글' 순위를 산정하여 사용자에게 제공하는 로직도 효율적으로 구현하였다.
